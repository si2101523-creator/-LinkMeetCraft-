<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- 1. TITLE: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –ø–æ–∏—Å–∫–æ–≤–∏–∫–æ–≤ -->
    <title>–¢–∏–º–º–µ–π—Ç—ã –¥–ª—è Minecraft, CS2, Dota 2 | LinkMeetCraft - –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫</title>
    
    <!-- 2. –ú–ï–¢–ê-–û–ü–ò–°–ê–ù–ò–ï -->
    <meta name="description" content="–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–∏–º–º–µ–π—Ç–æ–≤ –∏ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è Minecraft, CS2, Dota 2, RUST –∏ –¥—Ä—É–≥–∏—Ö –æ–Ω–ª–∞–π–Ω-–∏–≥—Ä. –ù–∞–π–¥–∏—Ç–µ –±–∏–ª–¥–µ—Ä–∞, –∫–æ–¥–µ—Ä–∞ –∏–ª–∏ –Ω–∞–ø–∞—Ä–Ω–∏–∫–∞ –¥–ª—è –º–∏—Å—Å–∏–∏ –∑–∞ 5 –º–∏–Ω—É—Ç.">
    
    <!-- 3. –ö–õ–Æ–ß–ï–í–´–ï –°–õ–û–í–ê -->
    <meta name="keywords" content="—Ç–∏–º–º–µ–π—Ç—ã, minecraft, cs2, dota 2, –ø–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥—ã, –Ω–∞–π—Ç–∏ –Ω–∞–ø–∞—Ä–Ω–∏–∫–∞, –∫–æ–¥–µ—Ä, –±–∏–ª–¥–µ—Ä, –≥–µ–π–º–∏–Ω–≥, LinkMeetCraft">
    
    <!-- –¢–ï–ì–ò –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –í–õ–ê–î–ï–ù–ò–Ø -->
    <meta name="google-site-verification" content="F3-qIwKF7rrBELT89F9YjqvQFiSNPg66pjBTJVJjsoM" />
    <meta name="yandex-verification" content="b631ed6c682d5bd3" />

    <!-- Yandex.Metrika counter (–°—á–µ—Ç—á–∏–∫ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∏) -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){
            m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();
            for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
            k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
        })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105532663', 'ym');

        ym(105532663, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/105532663" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- –®—Ä–∏—Ñ—Ç Orbitron -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'gamer': ['Orbitron', 'sans-serif'],
                        'ui': ['Rajdhani', 'sans-serif'],
                    },
                    colors: {
                        neonBlue: '#00f3ff',
                        neonOrange: '#ff6600',
                        darkBg: '#0b0d17',
                        panelBg: 'rgba(20, 24, 36, 0.85)',
                    },
                    boxShadow: {
                        'neon-blue': '0 0 10px rgba(0, 243, 255, 0.5)',
                        'neon-orange': '0 0 10px rgba(255, 102, 0, 0.5)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-image: url('https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=2070&auto=format&fit=crop'); 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #e6edf3;
            overflow: hidden;
        }
        .bg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 5, 10, 0.85);
            backdrop-filter: blur(3px);
            z-index: -1;
        }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0b0d17; }
        ::-webkit-scrollbar-thumb { background: #00f3ff; border-radius: 3px; }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 243, 255, 0.1);
        }

        .nav-btn {
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            cursor: pointer;
        }
        .nav-btn:hover {
            background: linear-gradient(90deg, rgba(0, 243, 255, 0.1) 0%, transparent 100%);
            border-left-color: #00f3ff;
            color: #00f3ff;
        }
        .nav-btn.active {
            background: linear-gradient(90deg, rgba(255, 102, 0, 0.2) 0%, transparent 100%);
            border-left-color: #ff6600;
            color: #ff6600;
            text-shadow: 0 0 8px rgba(255, 102, 0, 0.6);
        }

        .action-disabled {
            opacity: 0.5;
            cursor: not-allowed;
            filter: grayscale(100%);
            pointer-events: none;
        }
        
        .status-dot {
            animation: pulse-glow 2s infinite;
        }
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(0, 243, 255, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 243, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 243, 255, 0); }
        }

        @media (max-width: 768px) {
            .mobile-sidebar {
                max-height: 35vh;
                overflow-y: auto;
            }
            .mobile-main {
                height: 65vh;
            }
        }
    </style>
</head>
<body class="flex flex-col md:flex-row h-screen font-ui text-lg">
    <div class="bg-overlay"></div>

    <div id="error-display" class="hidden fixed top-0 left-0 w-full bg-red-600/90 backdrop-blur text-white p-4 z-[9999] font-bold text-center border-b-2 border-red-400"></div>

    <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <aside class="w-full md:w-72 glass-panel border-r border-gray-700/50 flex flex-col p-5 z-20 h-auto md:h-screen relative mobile-sidebar">
        <h1 class="text-3xl font-gamer font-bold text-transparent bg-clip-text bg-gradient-to-r from-neonOrange to-yellow-400 mb-8 tracking-wider drop-shadow-lg select-none">
            LinkMeet<span class="text-neonBlue">Craft</span>
        </h1>

        <!-- –ü–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞ -->
        <div id="auth-box" class="bg-black/40 p-4 rounded-xl border border-gray-700 mb-6 shadow-lg transition-all duration-300">
            <div id="login-view">
                <p class="text-sm text-neonBlue mb-2 font-bold uppercase tracking-widest" id="login-title">–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</p>
                <input type="text" id="nickname-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ù–∏–∫–Ω–µ–π–º" class="w-full bg-gray-900/80 border border-gray-600 rounded p-2 text-white mb-3 focus:border-neonBlue focus:outline-none focus:shadow-neon-blue transition-all placeholder-gray-600 font-mono" maxlength="20">
                <button id="login-btn" class="w-full bg-neonBlue/20 hover:bg-neonBlue/40 border border-neonBlue text-neonBlue font-bold py-2 rounded transition-all duration-300 hover:shadow-neon-blue uppercase text-sm">–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</button>
                <button id="cancel-edit-btn" class="w-full mt-2 text-gray-500 text-xs hover:text-white hidden uppercase tracking-wider">–û—Ç–º–µ–Ω–∞</button>
            </div>
            <div id="user-view" class="hidden">
                <div class="flex items-center gap-3 mb-2">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-neonOrange to-red-600 flex items-center justify-center text-white font-bold text-xl shadow-neon-orange">
                        <span id="avatar-letter">U</span>
                    </div>
                    <div class="overflow-hidden">
                        <div class="text-gray-400 text-xs uppercase tracking-wider">–û–ø–µ—Ä–∞—Ç–æ—Ä</div>
                        <div id="current-nickname" class="text-white font-bold text-lg tracking-wide truncate">User</div>
                    </div>
                </div>
                <div class="h-px w-full bg-gray-700 my-2"></div>
                <button id="edit-nick-btn" class="text-xs text-neonOrange hover:text-yellow-300 w-full text-left flex items-center transition-colors py-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" /></svg>
                    –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫ (—Ä–∞–∑ –≤ 30 –¥–Ω–µ–π)
                </button>
            </div>
        </div>

        <nav id="main-nav" class="flex-1 space-y-3">
            <button data-view="profiles" class="nav-btn active w-full text-left p-3 rounded text-gray-300 flex items-center">
                <span class="mr-3 text-xl">üìÑ</span> –ê–Ω–∫–µ—Ç—ã
            </button>
            <button data-view="chat" class="nav-btn w-full text-left p-3 rounded text-gray-300 flex items-center">
                <span class="mr-3 text-xl">üí¨</span> –û–±—â–∏–π —á–∞—Ç
            </button>
            <button data-view="create" class="nav-btn w-full text-left p-3 rounded text-gray-300 flex items-center">
                <span class="mr-3 text-xl">‚ûï</span> –°–æ–∑–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É
            </button>
        </nav>

        <div class="mt-auto pt-6 border-t border-gray-700 hidden md:block">
            <p class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-3">–°–æ–æ–±—â–µ—Å—Ç–≤–æ</p>
            <div class="space-y-2">
                <a href="https://t.me/LinkMeetCraft" target="_blank" class="block w-full p-2 rounded bg-[#2AABEE]/10 border border-[#2AABEE]/30 text-[#2AABEE] hover:bg-[#2AABEE]/20 hover:shadow-[0_0_10px_rgba(42,171,238,0.3)] transition-all flex items-center justify-center text-sm font-bold">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>
                    Telegram
                </a>
                <a href="https://www.youtube.com/@–ø–∞–ø–≥–º–æ–±–∞–∏–ª-–¥3—ç" target="_blank" class="block w-full p-2 rounded bg-[#FF0000]/10 border border-[#FF0000]/30 text-[#FF0000] hover:bg-[#FF0000]/20 hover:shadow-[0_0_10px_rgba(255,0,0,0.3)] transition-all flex items-center justify-center text-sm font-bold">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
                    YouTube
                </a>
            </div>
        </div>
    </aside>

    <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–ö–æ–Ω—Ç–µ–Ω—Ç) -->
    <main class="flex-1 relative overflow-hidden flex flex-col h-screen md:h-full bg-black/50 backdrop-blur-sm mobile-main">
        
        <div id="toast" class="absolute top-4 right-4 bg-gray-800 border-l-4 border-neonBlue text-white px-6 py-4 rounded shadow-2xl transform translate-x-full transition-transform duration-300 z-50 flex items-center">
            <div class="mr-3 text-neonBlue">‚ÑπÔ∏è</div>
            <div id="toast-message"></div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω: –ê–Ω–∫–µ—Ç—ã -->
        <div id="view-profiles" class="view-section h-full overflow-y-auto p-6 custom-scrollbar">
            <div class="flex items-center justify-between mb-6 border-b border-gray-700 pb-4">
                <h2 class="text-3xl font-gamer font-bold text-white">–ê–∫—Ç–∏–≤–Ω—ã–µ <span class="text-neonOrange">–ú–∏—Å—Å–∏–∏</span> –∏ –ø–æ–∏—Å–∫ —Ç–∏–º–º–µ–π—Ç–æ–≤</h2>
                <div class="text-xs text-gray-500 font-mono">LIVE FEED</div>
            </div>
            
            <!-- SEO Text -->
            <div class="bg-gray-900/40 p-4 rounded-xl mb-6 text-sm text-gray-300 border border-gray-700/50">
                <h3 class="text-lg font-bold text-neonBlue mb-2 font-ui">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –≥–µ–π–º–µ—Ä–æ–≤:</h3>
                <p>LinkMeetCraft ‚Äî —ç—Ç–æ –≤–∞—à —Ü–µ–Ω—Ç—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∞–¥–µ–∂–Ω—ã—Ö —Ç–∏–º–º–µ–π—Ç–æ–≤. –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –Ω—É–∂–µ–Ω –ª–∏ –≤–∞–º <span class="text-neonOrange">–±–∏–ª–¥–µ—Ä –¥–ª—è Minecraft</span>, —Ç–æ—á–Ω—ã–π <span class="text-neonOrange">—Å–Ω–∞–π–ø–µ—Ä –¥–ª—è CS2</span> –∏–ª–∏ —Å–ª–∞–∂–µ–Ω–Ω—ã–π —Å–∞–ø–ø–æ—Ä—Ç –¥–ª—è <span class="text-neonOrange">Dota 2</span>, –≤—ã –Ω–∞–π–¥–µ—Ç–µ —Å–≤–æ—é –∫–æ–º–∞–Ω–¥—É –∑–¥–µ—Å—å. –í—Å–µ –∞–Ω–∫–µ—Ç—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –í—Å—Ç—É–ø–∞–π—Ç–µ –≤ –∏–≥—Ä—É!</p>
            </div>

            <div id="profiles-container" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="text-neonBlue col-span-full text-center p-10 border border-dashed border-gray-700 rounded-xl animate-pulse">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–Ω–∫–µ—Ç...
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω: –ß–∞—Ç -->
        <div id="view-chat" class="view-section h-full flex flex-col p-4 hidden">
            <div class="flex items-center justify-between mb-4 border-b border-gray-700 pb-2">
                <h2 class="text-2xl font-gamer font-bold text-white">–û–±—â–∏–π <span class="text-neonBlue">–ß–∞—Ç</span></h2>
                <div class="flex items-center">
                    <div class="w-2 h-2 bg-green-500 rounded-full mr-2 status-dot"></div>
                    <span class="text-xs text-green-400 font-mono">ONLINE</span>
                </div>
            </div>

            <div id="chat-container" class="flex-1 overflow-y-auto space-y-3 mb-4 pr-2 custom-scrollbar bg-black/20 rounded-xl p-4 border border-gray-800">
                <div class="text-center text-gray-600 mt-10 font-mono">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...</div>
            </div>
            <div class="flex gap-3 bg-gray-900/80 p-3 rounded-xl border border-gray-700">
                <input type="text" id="chat-input" placeholder="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —ç—Ñ–∏—Ä..." class="flex-1 bg-transparent border-none text-white focus:ring-0 placeholder-gray-600 outline-none" disabled>
                <button id="send-msg-btn" class="bg-gradient-to-r from-blue-600 to-neonBlue hover:from-blue-500 hover:to-cyan-300 text-black font-bold py-2 px-6 rounded-lg transition-all duration-200 shadow-neon-blue action-disabled">SEND</button>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω: –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã -->
        <div id="view-create" class="view-section h-full overflow-y-auto p-6 hidden custom-scrollbar">
            <h2 class="text-3xl font-gamer font-bold text-white mb-6">–ù–æ–≤–∞—è <span class="text-neonOrange">–ê–Ω–∫–µ—Ç–∞</span></h2>
            <div class="bg-gray-900/80 border border-gray-700 p-8 rounded-2xl shadow-2xl max-w-3xl mx-auto">
                <form id="create-form" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-neonBlue text-sm font-bold mb-2 uppercase tracking-wide">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ / –¶–µ–ª—å</label>
                            <input type="text" id="f-title" required class="w-full bg-black/50 border border-gray-600 rounded p-3 text-white focus:border-neonOrange focus:outline-none focus:shadow-neon-orange transition-all" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: RPG –°–µ—Ä–≤–µ—Ä –∏–ª–∏ –ò—â—É 5-–≥–æ –¥–ª—è CS2">
                        </div>
                        <div>
                            <label class="block text-neonBlue text-sm font-bold mb-2 uppercase tracking-wide">–ö–æ–≥–æ –∏—â–µ—Ç–µ (–†–æ–ª—å)</label>
                            <input type="text" id="f-role" required class="w-full bg-black/50 border border-gray-600 rounded p-3 text-white focus:border-neonOrange focus:outline-none focus:shadow-neon-orange transition-all" placeholder="–°—Ç—Ä–æ–∏—Ç–µ–ª—å / –ö–æ–¥–µ—Ä / –°–∞–ø–ø–æ—Ä—Ç">
                        </div>
                    </div>
                    <div>
                        <label class="block text-neonBlue text-sm font-bold mb-2 uppercase tracking-wide">–û–ø–∏—Å–∞–Ω–∏–µ / –°—Ç–µ–∫</label>
                        <textarea id="f-desc" required rows="5" class="w-full bg-black/50 border border-gray-600 rounded p-3 text-white focus:border-neonOrange focus:outline-none focus:shadow-neon-orange transition-all" placeholder="–î–µ—Ç–∞–ª–∏ –º–∏—Å—Å–∏–∏, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–≥—Ä–æ–∫–∞–º, –æ–ø—ã—Ç..."></textarea>
                    </div>
                    <div>
                        <label class="block text-neonBlue text-sm font-bold mb-2 uppercase tracking-wide">–°–≤—è–∑—å (Discord/TG)</label>
                        <div class="flex">
                            <span class="inline-flex items-center px-3 rounded-l border border-r-0 border-gray-600 bg-gray-800 text-gray-400 text-sm">@</span>
                            <input type="text" id="f-contact" required maxlength="25" class="w-full bg-black/50 border border-gray-600 rounded-r p-3 text-white focus:border-neonOrange focus:outline-none focus:shadow-neon-orange transition-all" placeholder="username">
                        </div>
                    </div>
                    <button type="submit" id="create-submit-btn" class="w-full bg-gradient-to-r from-orange-600 to-neonOrange hover:from-orange-500 hover:to-yellow-500 text-black font-bold py-4 rounded-lg mt-4 transition-all duration-200 shadow-neon-orange text-lg uppercase tracking-widest action-disabled" disabled>
                        –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ê–Ω–∫–µ—Ç—É
                    </button>
                </form>
            </div>
        </div>

    </main>

    <!-- –°–ö–†–ò–ü–¢ –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, updateProfile, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, limit, onSnapshot, serverTimestamp, doc, setDoc, getDoc, deleteDoc, where, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --- –í–ê–®–ê –†–ê–ë–û–ß–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø FIREBASE ---
        const firebaseConfig = {
            apiKey: "AIzaSyA7EumEru2qfYcAyxAWLL4TY_dWfcU3Dfg",
            authDomain: "linkmeetcraft.firebaseapp.com",
            projectId: "linkmeetcraft",
            storageBucket: "linkmeetcraft.firebasestorage.app",
            messagingSenderId: "373052253470",
            appId: "1:373052253470:web:a66afc67876f76dc1a550f",
            measurementId: "G-WSZL0NRHCQ"
        };

        const appId = "linkmeetcraft";
        
        let firebaseApp, auth, db;
        let currentUser = null;
        let isFirebaseReady = false;

        // --- –ü–£–¢–ò ---
        const PATH_PROFILES = `/artifacts/${appId}/public/data/profiles`;
        const PATH_CHAT = `/artifacts/${appId}/public/data/chat`;
        const PATH_USERS = `/artifacts/${appId}/users`;

        // --- –ì–õ–û–ë–ê–õ–¨–ù–û–ï –£–ü–†–ê–í–õ–ï–ù–ò–ï –í–ò–î–ê–ú–ò ---
        window.app = {
            setView: (viewName) => {
                document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
                const targetView = document.getElementById(`view-${viewName}`);
                if (targetView) targetView.classList.remove('hidden');
                
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.view === viewName) btn.classList.add('active');
                });

                if (viewName === 'chat') {
                    const chatContainer = document.getElementById('chat-container');
                    if (chatContainer) setTimeout(() => chatContainer.scrollTop = chatContainer.scrollHeight, 0);
                }
            }
        };

        // --- UI –§–£–ù–ö–¶–ò–ò ---
        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').innerText = msg;
            toast.style.transform = 'translateX(0)';
            setTimeout(() => toast.style.transform = 'translateX(120%)', 4000);
        }

        function updateActionButtons(enabled) {
            const btns = [document.getElementById('send-msg-btn'), document.getElementById('create-submit-btn')];
            const inputs = [document.getElementById('chat-input')];
            
            btns.forEach(btn => {
                btn.disabled = !enabled;
                if (enabled) btn.classList.remove('action-disabled');
                else btn.classList.add('action-disabled');
            });
            inputs.forEach(input => input.disabled = !enabled);
        }

        function updateAuthUI(user) {
            const loginView = document.getElementById('login-view');
            const userView = document.getElementById('user-view');
            
            if (user && user.displayName) {
                currentUser = user;
                loginView.classList.add('hidden');
                userView.classList.remove('hidden');
                document.getElementById('current-nickname').innerText = user.displayName;
                document.getElementById('avatar-letter').innerText = user.displayName.charAt(0).toUpperCase();
                updateActionButtons(true);
            } else {
                currentUser = null;
                loginView.classList.remove('hidden');
                userView.classList.add('hidden');
                updateActionButtons(false);
            }
        }

        function copyToClipboard(text) {
            const tempInput = document.createElement('input');
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            try {
                document.execCommand('copy'); 
                showToast("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä!");
            } catch (err) {
                showToast("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è");
            }
            document.body.removeChild(tempInput);
        }

        // --- –õ–û–ì–ò–ö–ê ---
        async function init() {
            try {
                firebaseApp = initializeApp(firebaseConfig);
                auth = getAuth(firebaseApp);
                db = getFirestore(firebaseApp);
                isFirebaseReady = true;

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        if (user.displayName) {
                            updateAuthUI(user);
                            setupListeners();
                        } else {
                            updateAuthUI(null); 
                            setupProfilesListener(); 
                        }
                    } else {
                        signInAnonymously(auth).catch(e => console.log("Anon auth pending user interaction"));
                        updateAuthUI(null); 
                        setupProfilesListener();
                    }
                });
            } catch(e) {
                console.error(e);
                document.getElementById('error-display').innerText = "–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: " + e.message;
                document.getElementById('error-display').classList.remove('hidden');
            }
        }

        async function handleLogin() {
            const nick = document.getElementById('nickname-input').value.trim();
            if(nick.length < 3) return showToast("–ù–∏–∫ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π!");
            
            try {
                if (!auth.currentUser) await signInAnonymously(auth);
                const uid = auth.currentUser.uid;

                // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
                const usersRef = collection(db, PATH_USERS);
                const qUnique = query(usersRef, where("nickname", "==", nick));
                const nickSnap = await getDocs(qUnique);
                
                if (!nickSnap.empty) {
                    let isTaken = false;
                    nickSnap.forEach(doc => { if (doc.data().uid !== uid) isTaken = true; });
                    if (isTaken) return showToast(`–ù–∏–∫–Ω–µ–π–º "${nick}" —É–∂–µ –∑–∞–Ω—è—Ç.`);
                }
                
                // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–π–º–µ—Ä–∞
                const userRef = doc(db, PATH_USERS, uid);
                const userSnap = await getDoc(userRef);
                const now = Date.now();
                const COOLDOWN = 2592000000; // 30 –¥–Ω–µ–π

                if (userSnap.exists()) {
                    const data = userSnap.data();
                    if (auth.currentUser.displayName === nick) {
                         updateAuthUI(auth.currentUser);
                         cancelEditMode();
                         return;
                    }
                    if (now - (data.lastChange || 0) < COOLDOWN) {
                         const daysLeft = Math.ceil((COOLDOWN - (now - (data.lastChange||0))) / (86400000));
                         return showToast(`–°–º–µ–Ω–∞ –Ω–∏–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞. –ñ–¥–∞—Ç—å: ${daysLeft} –¥.`);
                    }
                }

                // 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                await updateProfile(auth.currentUser, { displayName: nick });
                await setDoc(userRef, { nickname: nick, lastChange: now, uid }, { merge: true });
                updateAuthUI(auth.currentUser);
                cancelEditMode();
                showToast(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${nick}!`);
                setupListeners();
            } catch (e) {
                showToast("–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞/—Å–º–µ–Ω—ã: " + e.message);
            }
        }

        function enableEditMode() {
            document.getElementById('user-view').classList.add('hidden');
            document.getElementById('login-view').classList.remove('hidden');
            document.getElementById('nickname-input').value = currentUser ? currentUser.displayName : '';
            document.getElementById('login-title').textContent = "–°–ú–ï–ù–ê –ù–ò–ö–ê (–†–ê–ó –í 30 –î–ù–ï–ô)";
            document.getElementById('cancel-edit-btn').classList.remove('hidden');
        }

        function cancelEditMode() {
             if (currentUser && currentUser.displayName) updateAuthUI(currentUser);
             document.getElementById('cancel-edit-btn').classList.add('hidden');
             document.getElementById('login-title').textContent = "–ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø";
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            if (!text || !currentUser) return;
            try {
                input.value = '';
                await addDoc(collection(db, PATH_CHAT), {
                    text,
                    author: currentUser.displayName,
                    uid: currentUser.uid,
                    createdAt: serverTimestamp()
                });
            } catch(e) {
                showToast("–û—à–∏–±–∫–∞: " + e.message);
            }
        }

        async function createProfile(e) {
            e.preventDefault();
            if(!currentUser) return showToast("–ù—É–∂–Ω–æ –≤–æ–π—Ç–∏, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞–Ω–∫–µ—Ç—ã!");
            const title = document.getElementById('f-title').value;
            const role = document.getElementById('f-role').value;
            const desc = document.getElementById('f-desc').value;
            const contact = document.getElementById('f-contact').value;
            if(!title || !role || !contact) return showToast("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è!");

            try {
                await addDoc(collection(db, PATH_PROFILES), {
                    title, role, desc, contact,
                    author: currentUser.displayName,
                    uid: currentUser.uid,
                    createdAt: serverTimestamp()
                });
                showToast("–ê–Ω–∫–µ—Ç–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞!");
                e.target.reset();
                window.app.setView('profiles');
            } catch(e) {
                showToast("–û—à–∏–±–∫–∞: " + e.message);
            }
        }

        async function deleteProfile(id) {
            if(!confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∞–Ω–∫–µ—Ç—É?")) return;
            try {
                await deleteDoc(doc(db, PATH_PROFILES, id));
                showToast("–£–¥–∞–ª–µ–Ω–æ.");
            } catch(e) {
                showToast("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è.");
            }
        }

        function setupProfilesListener() {
            const q = query(collection(db, PATH_PROFILES), limit(50));
            onSnapshot(q, (snap) => {
                const cont = document.getElementById('profiles-container');
                cont.innerHTML = '';
                if(snap.empty) {
                    cont.innerHTML = '<div class="col-span-full text-gray-500 text-center">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–Ω–∫–µ—Ç.</div>';
                    return;
                }
                const items = [];
                snap.forEach(d => items.push({id: d.id, ...d.data()}));
                items.sort((a,b) => (b.createdAt?.toMillis() || 0) - (a.createdAt?.toMillis() || 0));

                items.forEach(p => {
                    const isOwner = currentUser && p.uid === currentUser.uid;
                    const el = document.createElement('div');
                    el.className = `bg-gray-900/60 border ${isOwner ? 'border-neonOrange' : 'border-gray-700'} p-6 rounded-xl hover:bg-gray-800/60 transition-all duration-300 shadow-lg backdrop-blur-sm`;
                    el.innerHTML = `
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="text-xl font-bold text-white">${p.title}</h3>
                            ${isOwner ? `<button class="del-btn text-red-500 hover:text-red-400" data-id="${p.id}">‚úï</button>` : ''}
                        </div>
                        <div class="text-neonBlue font-mono text-sm mb-2 uppercase tracking-wider">${p.role}</div>
                        <p class="text-gray-400 text-sm mb-4 line-clamp-3">${p.desc}</p>
                        <div class="flex justify-between items-center pt-4 border-t border-gray-800">
                            <span class="text-xs text-gray-500 font-bold uppercase">${p.author}</span>
                            <button class="copy-btn bg-gray-800 hover:bg-gray-700 text-white text-xs px-3 py-1 rounded border border-gray-600 transition" data-contact="${p.contact}">–°–≤—è–∑—å</button>
                        </div>
                    `;
                    el.querySelector('.copy-btn').onclick = () => copyToClipboard(p.contact);
                    if(isOwner) el.querySelector('.del-btn').onclick = () => deleteProfile(p.id);
                    cont.appendChild(el);
                });
            });
        }

        function setupListeners() {
            if (!currentUser) return;
            const qChat = query(collection(db, PATH_CHAT), limit(50));
            onSnapshot(qChat, (snap) => {
                const cont = document.getElementById('chat-container');
                cont.innerHTML = '';
                const msgs = [];
                snap.forEach(d => msgs.push(d.data()));
                msgs.sort((a,b) => (a.createdAt?.toMillis() || 0) - (b.createdAt?.toMillis() || 0));
                msgs.forEach(m => {
                    const isMe = currentUser && m.uid === currentUser.uid;
                    const div = document.createElement('div');
                    div.className = `flex ${isMe ? 'justify-end' : 'justify-start'} mb-3`;
                    div.innerHTML = `
                        <div class="${isMe ? 'bg-neonBlue/20 border-neonBlue/50' : 'bg-gray-800 border-gray-600'} border px-4 py-2 rounded-xl max-w-[80%] backdrop-blur-sm">
                            <div class="text-[10px] ${isMe ? 'text-neonBlue' : 'text-neonOrange'} font-bold mb-1 uppercase">${m.author}</div>
                            <div class="text-white text-sm">${m.text}</div>
                        </div>
                    `;
                    cont.appendChild(div);
                });
                if(!document.getElementById('view-chat').classList.contains('hidden')) cont.scrollTop = cont.scrollHeight;
            });
            setupProfilesListener();
        }

        window.onload = () => {
            init();
            document.getElementById('login-btn').onclick = handleLogin;
            document.getElementById('edit-nick-btn').onclick = enableEditMode;
            document.getElementById('cancel-edit-btn').onclick = cancelEditMode;
            document.getElementById('send-msg-btn').onclick = sendMessage;
            document.getElementById('chat-input').onkeypress = (e) => { if(e.key === 'Enter') sendMessage() };
            document.getElementById('create-form').onsubmit = createProfile;
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.onclick = () => window.app.setView(btn.dataset.view);
            });
            window.app.setView('profiles');
        };
    </script>
</body>
</html>
