<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkMeetCraft | –ù–∞–π–¥–∏ –°–≤–æ—é –ö–æ–º–∞–Ω–¥—É</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π Tailwind CSS (–¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- –®—Ä–∏—Ñ—Ç Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* –°—Ç–∏–ª–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ */
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
    </style>

    <!-- üî• –ì–õ–ê–í–ù–´–ô –°–ö–†–ò–ü–¢ (FIREBASE + TELEGRAM) üî• -->
    <script type="module">
        // –ò–º–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, limit, getDoc, doc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // ======================================================
        // üëá –í–ê–®–ò –ù–ê–°–¢–†–û–ô–ö–ò (–£–ñ–ï –ó–ê–ü–û–õ–ù–ï–ù–´) üëá
        // ======================================================

        const firebaseConfig = {
          apiKey: "AIzaSyA7EumEru2qfYcAyxAWLL4TY_dWfcU3Dfg",
          authDomain: "linkmeetcraft.firebaseapp.com",
          projectId: "linkmeetcraft",
          storageBucket: "linkmeetcraft.firebasestorage.app",
          messagingSenderId: "373052253470",
          appId: "1:373052253470:web:a66afc67876f76dc1a550f"
        };

        const TG_CHAT_ID = "-1003295508709";

        // ======================================================

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        let TELEGRAM_BOT_TOKEN = null;

        // --- 1. –ü–û–õ–£–ß–ï–ù–ò–ï –¢–û–ö–ï–ù–ê –ò–ó –ë–ê–ó–´ ---
        async function initApp() {
            try {
                // –ê–Ω–æ–Ω–∏–º–Ω—ã–π –≤—Ö–æ–¥ (–¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ)
                await signInAnonymously(auth);
                
                // –ß—Ç–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ settings/telegram
                const docSnap = await getDoc(doc(db, "settings", "telegram"));
                if (docSnap.exists()) {
                    TELEGRAM_BOT_TOKEN = docSnap.data().token;
                    console.log("–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ.");
                } else {
                    console.error("–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ (settings/telegram)");
                    alert("–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö!");
                }
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", error);
            }
        }

        // --- 2. –û–¢–ü–†–ê–í–ö–ê –ê–ù–ö–ï–¢–´ ---
        window.sendForm = async (e) => {
            e.preventDefault(); // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            
            if (!TELEGRAM_BOT_TOKEN) {
                alert("–ü–æ–¥–æ–∂–¥–∏—Ç–µ —Å–µ–∫—É–Ω–¥—É, —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...");
                await initApp();
                return;
            }

            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–æ–ª–µ–π
            const name = document.getElementById('name').value;
            const game = document.getElementById('game').value; 
            const contact = document.getElementById('contact').value;
            const desc = document.getElementById('desc').value;

if(!name  !game  !contact) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ò–º—è, –ò–≥—Ä—É –∏ –ö–æ–Ω—Ç–∞–∫—Ç—ã.");
                return;
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            document.getElementById('loading').style.display = 'flex';

            try {
                // –ê. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ë–∞–∑—É –î–∞–Ω–Ω—ã—Ö (—á—Ç–æ–±—ã –±—ã–ª–æ –Ω–∞ —Å–∞–π—Ç–µ)
                await addDoc(collection(db, "teammates"), {
                    name: name,
                    role: game,
                    contact: contact,
                    about: desc,
                    timestamp: Date.now()
                });

                // –ë. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram (—á—Ç–æ–±—ã –ø—Ä–∏—à–ª–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ)
                const text = 
üéÆ <b>–ù–û–í–ê–Ø –ê–ù–ö–ï–¢–ê!</b>

üë§ <b>–ò–≥—Ä–æ–∫:</b> ${name}
üïπ <b>–ò–≥—Ä–∞/–†–æ–ª—å:</b> ${game}
üìû <b>–°–≤—è–∑—å:</b> ${contact}
üìù <b>–û–ø–∏—Å–∞–Ω–∏–µ:</b> ${desc}
                ;

                await fetch(https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        chat_id: TG_CHAT_ID,
                        text: text,
                        parse_mode: 'HTML'
                    })
                });

                alert("‚úÖ –ê–Ω–∫–µ—Ç–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞!");
                document.getElementById('form').reset(); // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É

            } catch (error) {
                console.error(error);
                alert("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: " + error.message);
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        };

        // --- 3. –ó–ê–ì–†–£–ó–ö–ê –°–ü–ò–°–ö–ê –ê–ù–ö–ï–¢ (REALTIME) ---
        function loadTeammates() {
            const listDiv = document.getElementById('teammates-list');
            
            // –°–ª—É—à–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–±–µ—Ä–µ–º 50 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö)
            const q = query(collection(db, "teammates"), limit(50));

            onSnapshot(q, (snapshot) => {
                const items = [];
                snapshot.forEach(doc => items.push(doc.data()));
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º: –Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É
                items.sort((a, b) => b.timestamp - a.timestamp);

                listDiv.innerHTML = ""; // –û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫

                if (items.length === 0) {
                    listDiv.innerHTML = "<p class='text-center text-gray-500'>–ê–Ω–∫–µ—Ç –ø–æ–∫–∞ –Ω–µ—Ç. –°—Ç–∞–Ω—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>";
                    return;
                }

                items.forEach(item => {
                    // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è –∫–∞–∂–¥–æ–π –∞–Ω–∫–µ—Ç—ã
                    const date = new Date(item.timestamp).toLocaleDateString();
                    // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Å—ã–ª–∫–∞
                    let link = item.contact;
                    if (!link.startsWith('http') && !link.startsWith('@')) {
                        link = '#'; 
                    }
                    
                    const card = 
                        <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100 mb-4 card-hover transition duration-300">
                            <div class="flex justify-between items-start">
                                <h3 class="font-bold text-lg text-gray-800">${item.name}</h3>
                                <span class="text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded">${date}</span>
                            </div>
                            <div class="mt-2 text-blue-600 font-medium">üéÆ ${item.role}</div>
                            <p class="text-gray-600 mt-2 text-sm whitespace-pre-wrap">${item.about}</p>
                            <div class="mt-4 pt-3 border-t border-gray-100">
                                <span class="text-gray-500 text-sm font-bold">üìû –°–≤—è–∑—å: </span>
                                <span class="text-blue-500 text-sm">${item.contact}</span>
                            </div>
                        </div>
                    ;
                    listDiv.innerHTML += card;
                });
            });
        }

// –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = () => {
            initApp();
            loadTeammates();
        };
    </script>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <header class="bg-white shadow-sm sticky top-0 z-10">
        <div class="max-w-4xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <span class="text-2xl">üëæ</span>
                <h1 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600">
                    LinkMeetCraft
                </h1>
            </div>
            <a href="https://t.me/LinkMeetCraft" target="_blank" class="text-sm text-blue-500 font-medium hover:underline">
                –ù–∞—à Telegram –∫–∞–Ω–∞–ª
            </a>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8 grid md:grid-cols-3 gap-6">
        
        <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –§–û–†–ú–ê -->
        <div class="md:col-span-1">
            <div class="bg-white p-6 rounded-2xl shadow-lg border border-blue-100 sticky top-24">
                <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <span>üìù</span> –ü–æ–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É
                </h2>
                <form id="form" onsubmit="sendForm(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">–í–∞—à –ù–∏–∫–Ω–µ–π–º</label>
                            <input type="text" id="name" placeholder="Steve_Pro" class="w-full bg-gray-50 border border-gray-200 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">–ò–≥—Ä–∞ / –†–æ–ª—å</label>
                            <input type="text" id="game" placeholder="Minecraft / –°—Ç—Ä–æ–∏—Ç–µ–ª—å" class="w-full bg-gray-50 border border-gray-200 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">–°–≤—è–∑—å (Telegram/Discord)</label>
                            <input type="text" id="contact" placeholder="@username" class="w-full bg-gray-50 border border-gray-200 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none transition" required>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea id="desc" rows="3" placeholder="–ò—â—É –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è..." class="w-full bg-gray-50 border border-gray-200 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none transition"></textarea>
                        </div>

                        <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 rounded-lg shadow-md transition transform active:scale-95 flex justify-center items-center gap-2">
                            <span>üöÄ</span> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –°–ü–ò–°–û–ö –ê–ù–ö–ï–¢ -->
        <div class="md:col-span-2">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-gray-800">–ê–∫—Ç–∏–≤–Ω—ã–µ –∞–Ω–∫–µ—Ç—ã</h2>
                <span class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full animate-pulse">Live</span>
            </div>

            <!-- –°—é–¥–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∞–Ω–∫–µ—Ç—ã -->

<div id="teammates-list" class="space-y-4">
                <!-- –ó–∞–≥–ª—É—à–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
                <div class="text-center py-10">
                    <div class="inline-block loader mb-4"></div>
                    <p class="text-gray-400">–ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...</p>
                </div>
            </div>
        </div>

    </main>

    <!-- –û–≤–µ—Ä–ª–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ -->
    <div id="loading" class="fixed inset-0 bg-white/80 backdrop-blur-sm hidden justify-center items-center z-50">
        <div class="text-center">
            <div class="loader mx-auto mb-4"></div>
            <p class="font-bold text-gray-600">–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ...</p>
        </div>
    </div>

    <footer class="text-center py-8 text-gray-400 text-sm">
        &copy; 2025 LinkMeetCraft. Powered by Firebase & Telegram.
    </footer>

</body>
</html>
