<!DOCTYPE html>
<html lang="ru">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>LinkMeetCraft - ĞŸĞ¾Ğ¸ÑĞº ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹</title>
Â  Â  <!-- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Tailwind CSS -->
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Inter', sans-serif;
Â  Â  Â  Â  Â  Â  background-color: #0d1117; /* Ğ§ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ğ½ */
Â  Â  Â  Â  Â  Â  color: #e6edf3;
Â  Â  Â  Â  Â  Â  height: 100vh;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Ğ¡ĞºÑ€Ğ¾Ğ»Ğ»Ğ±Ğ°Ñ€Ñ‹ */
Â  Â  Â  Â  ::-webkit-scrollbar { width: 8px; }
Â  Â  Â  Â  ::-webkit-scrollbar-track { background: #161b22; }
Â  Â  Â  Â  ::-webkit-scrollbar-thumb { background: #30363d; border-radius: 4px; }
Â  Â  Â  Â  
Â  Â  Â  Â  /* ĞšĞ»Ğ°ÑÑ Ğ´Ğ»Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¸ */
Â  Â  Â  Â  .nav-btn.active {
Â  Â  Â  Â  Â  Â  background-color: #1f242d; /* Ğ¢ĞµĞ¼Ğ½Ğ¾-ÑĞµÑ€Ñ‹Ğ¹ Ñ„Ğ¾Ğ½ */
Â  Â  Â  Â  Â  Â  color: #ffffff;
Â  Â  Â  Â  Â  Â  border-color: #3b82f6; /* Ğ¡Ğ¸Ğ½ÑÑ Ñ€Ğ°Ğ¼ĞºĞ° */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ğ¾Ğ¼ Firebase */
Â  Â  Â  Â  .firebase-disabled {
Â  Â  Â  Â  Â  Â  opacity: 0.5;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }
Â  Â  Â  Â  .line-clamp-3 {
Â  Â  Â  Â  Â  Â  display: -webkit-box;
Â  Â  Â  Â  Â  Â  -webkit-line-clamp: 3;
Â  Â  Â  Â  Â  Â  -webkit-box-orient: vertical;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body class="flex flex-col md:flex-row h-full">

Â  Â  <!-- Ğ‘Ğ›ĞĞš ĞĞ¢ĞĞ‘Ğ ĞĞ–Ğ•ĞĞ˜Ğ¯ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ¥ ĞĞ¨Ğ˜Ğ‘ĞĞš -->
Â  Â  <div id="error-display" class="hidden fixed top-0 left-0 w-full bg-red-600 text-white p-4 z-[9999] font-bold text-center"></div>

Â  Â  <!-- Ğ›ĞµĞ²Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ -->
Â  Â  <aside class="w-full md:w-64 bg-[#161b22] border-r border-[#30363d] flex flex-col p-4 z-20">
Â  Â  Â  Â  <h1 class="text-2xl font-bold text-orange-500 mb-6 tracking-wider">LinkMeetCraft</h1>

Â  Â  Â  Â  <!-- ĞŸĞ°Ğ½ĞµĞ»ÑŒ Ğ²Ñ…Ğ¾Ğ´Ğ° -->
Â  Â  Â  Â  <div id="auth-box" class="bg-[#0d1117] p-4 rounded-xl border border-[#30363d] mb-4 shadow-lg">
Â  Â  Â  Â  Â  Â  <!-- Ğ•ÑĞ»Ğ¸ Ğ½Ğµ Ğ²Ğ¾ÑˆĞµĞ» -->
Â  Â  Â  Â  Â  Â  <div id="login-view">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="nickname-input" placeholder="Ğ’Ğ°Ñˆ Ğ½Ğ¸ĞºĞ½ĞµĞ¹Ğ¼" class="w-full bg-[#21262d] border border-[#30363d] rounded p-2 text-white mb-2 focus:border-blue-500 outline-none" maxlength="20">
Â  Â  Â  Â  Â  Â  Â  Â  <button data-action="login" id="login-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 rounded transition">Ğ’Ğ¾Ğ¹Ñ‚Ğ¸</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <!-- Ğ•ÑĞ»Ğ¸ Ğ²Ğ¾ÑˆĞµĞ» -->
Â  Â  Â  Â  Â  Â  <div id="user-view" class="hidden">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-gray-400 text-xs">Ğ’Ñ‹ Ğ²Ğ¾ÑˆĞ»Ğ¸ ĞºĞ°Ğº:</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="current-nickname" class="text-blue-400 font-bold text-lg truncate"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <button data-action="logout" id="logout-btn" class="mt-2 text-xs text-red-400 hover:text-red-300 underline">Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ½Ğ¸Ğº</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ -->
Â  Â  Â  Â  <nav id="main-nav" class="flex-1 space-y-2">
Â  Â  Â  Â  Â  Â  <button data-view="profiles" class="nav-btn active w-full text-left p-3 rounded hover:bg-[#21262d] text-gray-300 hover:text-white transition flex items-center border border-transparent focus:border-blue-500">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ“„ ĞĞ½ĞºĞµÑ‚Ñ‹
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button data-view="chat" class="nav-btn w-full text-left p-3 rounded hover:bg-[#21262d] text-gray-300 hover:text-white transition flex items-center border border-transparent focus:border-blue-500">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ’¬ ĞĞ±Ñ‰Ğ¸Ğ¹ Ñ‡Ğ°Ñ‚
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button data-view="create" class="nav-btn w-full text-left p-3 rounded bg-orange-900/20 text-orange-400 hover:bg-orange-900/40 hover:text-orange-300 transition flex items-center border border-orange-900/50 mt-4">
Â  Â  Â  Â  Â  Â  Â  Â  â• Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ°Ğ½ĞºĞµÑ‚Ñƒ
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </nav>
Â  Â  </aside>

Â  Â  <!-- ĞŸÑ€Ğ°Ğ²Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ (ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚) -->
Â  Â  <main class="flex-1 relative bg-[#0d1117] overflow-hidden flex flex-col">
Â  Â  Â  Â  
Â  Â  Â  Â  <!-- Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ -->
Â  Â  Â  Â  <div id="toast" class="absolute top-4 right-4 bg-blue-600 text-white px-6 py-3 rounded shadow-xl transform translate-x-full transition-transform duration-300 z-50"></div>

Â  Â  Â  Â  <!-- Ğ­ĞºÑ€Ğ°Ğ½: ĞĞ½ĞºĞµÑ‚Ñ‹ -->
Â  Â  Â  Â  <div id="view-profiles" class="view-section h-full overflow-y-auto p-6">
Â  Â  Â  Â  Â  Â  <h2 class="text-2xl font-bold text-white mb-4 border-b border-[#30363d] pb-2">ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ°Ğ½ĞºĞµÑ‚Ñ‹</h2>
Â  Â  Â  Â  Â  Â  <div id="profiles-container" class="grid grid-cols-1 lg:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  <!-- ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ² JS -->
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-gray-500 col-span-full text-center p-4">ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ±Ğ°Ğ·Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…...</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- Ğ­ĞºÑ€Ğ°Ğ½: Ğ§Ğ°Ñ‚ -->
Â  Â  Â  Â  <div id="view-chat" class="view-section h-full flex flex-col p-4 hidden">
Â  Â  Â  Â  Â  Â  <h2 class="text-xl font-bold text-white mb-2 border-b border-[#30363d] pb-2">ĞĞ±Ñ‰Ğ¸Ğ¹ Ñ‡Ğ°Ñ‚</h2>
Â  Â  Â  Â  Â  Â  <div id="chat-container" class="flex-1 overflow-y-auto space-y-3 mb-4 pr-2">
Â  Â  Â  Â  Â  Â  Â  Â  <!-- ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ² JS -->
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center text-gray-600 mt-10">ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹...</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="flex gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="chat-input" placeholder="ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ..." class="flex-1 bg-[#21262d] border border-[#30363d] rounded p-3 text-white focus:border-blue-500 outline-none">
Â  Â  Â  Â  Â  Â  Â  Â  <button data-action="send-msg" id="send-msg-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 rounded font-bold firebase-disabled transition-colors duration-200">></button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- Ğ­ĞºÑ€Ğ°Ğ½: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ°Ğ½ĞºĞµÑ‚Ñ‹ -->
Â  Â  Â  Â  <div id="view-create" class="view-section h-full overflow-y-auto p-6 hidden">
Â  Â  Â  Â  Â  Â  <h2 class="text-2xl font-bold text-orange-500 mb-6">ĞĞ¾Ğ²Ğ°Ñ Ğ°Ğ½ĞºĞµÑ‚Ğ°</h2>
Â  Â  Â  Â  Â  Â  <form data-action="create-profile" id="create-form" class="max-w-2xl bg-[#161b22] p-6 rounded-xl border border-[#30363d] space-y-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-gray-400 text-sm mb-1">ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° / Ğ¦ĞµĞ»ÑŒ</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="f-title" required class="w-full bg-[#0d1117] border border-[#30363d] rounded p-2 text-white focus:border-orange-500 outline-none">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-gray-400 text-sm mb-1">ĞšĞ¾Ğ³Ğ¾ Ğ¸Ñ‰ĞµÑ‚Ğµ (Ğ Ğ¾Ğ»ÑŒ)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="f-role" required class="w-full bg-[#0d1117] border border-[#30363d] rounded p-2 text-white focus:border-orange-500 outline-none">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-gray-400 text-sm mb-1">ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ / Ğ¡Ñ‚ĞµĞº</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="f-desc" required rows="4" class="w-full bg-[#0d1117] border border-[#30363d] rounded p-2 text-white focus:border-orange-500 outline-none"></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-gray-400 text-sm mb-1">Ğ’Ğ°Ñˆ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚ (Telegram/Discord)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="f-contact" required class="w-full bg-[#0d1117] border border-[#30363d] rounded p-2 text-white focus:border-orange-500 outline-none">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" id="create-submit-btn" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 rounded mt-4 transition firebase-disabled">ĞĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ</button>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>

Â  Â  </main>

Â  Â  <!-- Ğ›ĞĞ’Ğ•Ğ¦ ĞĞ¨Ğ˜Ğ‘ĞĞš Ğ¡ĞšĞ Ğ˜ĞŸĞ¢Ğ Ğ˜ Ğ“Ğ›ĞĞ‘ĞĞ›Ğ¬ĞĞĞ¯ ĞĞĞ’Ğ˜Ğ“ĞĞ¦Ğ˜Ğ¯ -->
Â  Â  <script>
Â  Â  Â  Â  // Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ²Ğ¸Ğ´Ğ°
Â  Â  Â  Â  window.app = {
Â  Â  Â  Â  Â  Â  setView: (viewId) => {
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
Â  Â  Â  Â  Â  Â  Â  Â  const activeView = document.getElementById('view-' + viewId);
Â  Â  Â  Â  Â  Â  Â  Â  if (activeView) activeView.classList.remove('hidden');

Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll('.nav-btn').forEach(btn => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.remove('active');
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  const selectedBtn = document.querySelector(`.nav-btn[data-view="${viewId}"]`);
Â  Â  Â  Â  Â  Â  Â  Â  if (selectedBtn) selectedBtn.classList.add('active');

Â  Â  Â  Â  Â  Â  Â  Â  // ĞĞ²Ñ‚Ğ¾ÑĞºÑ€Ğ¾Ğ»Ğ» Ñ‡Ğ°Ñ‚Ğ° Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸
Â  Â  Â  Â  Â  Â  Â  Â  if(viewId === 'chat') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const container = document.getElementById('chat-container');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => container.scrollTop = container.scrollHeight, 100);Â 
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };

Â  Â  Â  Â  // Ğ›Ğ¾Ğ²ĞµÑ† Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
Â  Â  Â  Â  window.addEventListener('error', function(e) {
Â  Â  Â  Â  Â  Â  const display = document.getElementById('error-display');
Â  Â  Â  Â  Â  Â  // ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ "Cannot read properties of null (reading 'toMillis')" Ğ½Ğ° ÑÑ‚Ğ°Ñ€Ñ‚Ğµ
Â  Â  Â  Â  Â  Â  if (e.message.includes("toMillis") && e.filename.includes("firebase")) return;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (!display.innerText.includes("ĞŸĞ Ğ•Ğ”Ğ£ĞŸĞ Ğ•Ğ–Ğ”Ğ•ĞĞ˜Ğ•")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â display.innerText = "ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ¯ ĞĞ¨Ğ˜Ğ‘ĞšĞ: " + e.message + " (ÑĞ¼. ĞºĞ¾Ğ½ÑĞ¾Ğ»ÑŒ Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹)";
Â  Â  Â  Â  Â  Â  Â  Â  Â display.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  </script>

Â  Â  <!-- Ğ¡ĞšĞ Ğ˜ĞŸĞ¢ ĞŸĞ Ğ˜Ğ›ĞĞ–Ğ•ĞĞ˜Ğ¯ (ĞœĞ¾Ğ´ÑƒĞ»ÑŒ) -->
Â  Â  <script type="module">
Â  Â  Â  Â  // Ğ˜ĞœĞŸĞĞ Ğ¢Ğ« FIREBASE
Â  Â  Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
Â  Â  Â  Â  import { getAuth, signInAnonymously, updateProfile, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
Â  Â  Â  Â  import { getFirestore, collection, addDoc, query, limit, onSnapshot, serverTimestamp, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
Â  Â  Â  Â  
Â  Â  Â  Â  // --- ĞšĞĞĞ¤Ğ˜Ğ“Ğ£Ğ ĞĞ¦Ğ˜Ğ¯ Ğ˜ Ğ—ĞĞ©Ğ˜Ğ¢Ğ ---
Â  Â  Â  Â  const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
Â  Â  Â  Â  let firebaseConfig = {};
Â  Â  Â  Â  let isFirebaseReady = false;
Â  Â  Â  Â  
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  if (typeof __firebase_config === 'string' && __firebase_config.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  firebaseConfig = JSON.parse(__firebase_config);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Ğ•ÑĞ»Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ ĞµÑÑ‚ÑŒ, Ğ¿Ñ‹Ñ‚Ğ°ĞµĞ¼ÑÑ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
Â  Â  Â  Â  Â  Â  if (firebaseConfig && firebaseConfig.apiKey && firebaseConfig.projectId) {
Â  Â  Â  Â  Â  Â  Â  Â  isFirebaseReady = true;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â console.warn("Firebase configuration is missing vital keys. Disabling Firebase features.");
Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('error-display').innerText = "ĞŸĞ Ğ•Ğ”Ğ£ĞŸĞ Ğ•Ğ–Ğ”Ğ•ĞĞ˜Ğ•: ĞšĞ»ÑÑ‡ Firebase API Ğ½Ğµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½. Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ñ‡Ğ°Ñ‚Ğ° Ğ¸ Ğ°Ğ½ĞºĞµÑ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹.";
Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('error-display').classList.remove('hidden');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  console.error("Failed to parse __firebase_config.", e);
Â  Â  Â  Â  Â  Â  document.getElementById('error-display').innerText = "ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ¯ ĞĞ¨Ğ˜Ğ‘ĞšĞ: ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Firebase. Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹.";
Â  Â  Â  Â  Â  Â  document.getElementById('error-display').classList.remove('hidden');
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  let firebaseApp, auth, db;
Â  Â  Â  Â  
Â  Â  Â  Â  if (isFirebaseReady) {
Â  Â  Â  Â  Â  Â  firebaseApp = initializeApp(firebaseConfig);
Â  Â  Â  Â  Â  Â  auth = getAuth(firebaseApp);
Â  Â  Â  Â  Â  Â  db = getFirestore(firebaseApp);
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- ĞŸĞ£Ğ¢Ğ˜ Ğš FIRESTORE (Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¸ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹) ---
Â  Â  Â  Â  // ĞĞ½ĞºĞµÑ‚Ñ‹ Ğ¸ Ñ‡Ğ°Ñ‚ â€” Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ, Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ²ÑĞµĞ¼
Â  Â  Â  Â  const PATH_PROFILES = `/artifacts/${appId}/public/data/profiles`;
Â  Â  Â  Â  const PATH_CHAT = `/artifacts/${appId}/public/data/chat`;
Â  Â  Â  Â  // Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Ğ½Ğ¸ĞºĞ½ĞµĞ¹Ğ¼/ĞºÑƒĞ»Ğ´Ğ°ÑƒĞ½) â€” Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğµ, Ğ´Ğ»Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
Â  Â  Â  Â  const PATH_USERS = `/artifacts/${appId}/users`;Â 

Â  Â  Â  Â  let currentUser = null; // Ğ‘ÑƒĞ´ĞµÑ‚ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ¾Ğ±ÑŠĞµĞºÑ‚ { uid, displayName }

Â  Â  Â  Â  // --- Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜ Ğ˜ĞĞ¢Ğ•Ğ Ğ¤Ğ•Ğ™Ğ¡Ğ ---

Â  Â  Â  Â  function showToast(msg) {
Â  Â  Â  Â  Â  Â  const toast = document.getElementById('toast');
Â  Â  Â  Â  Â  Â  toast.innerText = msg;
Â  Â  Â  Â  Â  Â  toast.style.transform = 'translateX(0)';
Â  Â  Â  Â  Â  Â  setTimeout(() => toast.style.transform = 'translateX(120%)', 3000);
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateAuthUI(user) {
Â  Â  Â  Â  Â  Â  const loginView = document.getElementById('login-view');
Â  Â  Â  Â  Â  Â  const userView = document.getElementById('user-view');
Â  Â  Â  Â  Â  Â  const sendMsgBtn = document.getElementById('send-msg-btn');
Â  Â  Â  Â  Â  Â  const chatInput = document.getElementById('chat-input');
Â  Â  Â  Â  Â  Â  const createBtn = document.getElementById('create-submit-btn');
Â  Â  Â  Â  Â  Â  const createNavBtn = document.querySelector('.nav-btn[data-view="create"]');
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (user && user.displayName) {
Â  Â  Â  Â  Â  Â  Â  Â  currentUser = user;
Â  Â  Â  Â  Â  Â  Â  Â  loginView.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  userView.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('current-nickname').innerText = user.displayName;
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸
Â  Â  Â  Â  Â  Â  Â  Â  sendMsgBtn.classList.remove('firebase-disabled');
Â  Â  Â  Â  Â  Â  Â  Â  chatInput.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  createBtn.classList.remove('firebase-disabled');
Â  Â  Â  Â  Â  Â  Â  Â  createNavBtn.classList.remove('firebase-disabled');

Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  currentUser = null;
Â  Â  Â  Â  Â  Â  Â  Â  loginView.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  userView.classList.add('hidden');

Â  Â  Â  Â  Â  Â  Â  Â  // ĞÑ‚ĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸
Â  Â  Â  Â  Â  Â  Â  Â  sendMsgBtn.classList.add('firebase-disabled');
Â  Â  Â  Â  Â  Â  Â  Â  chatInput.disabled = true;
Â  Â  Â  Â  Â  Â  Â  Â  createBtn.classList.add('firebase-disabled');
Â  Â  Â  Â  Â  Â  Â  Â  createNavBtn.classList.add('firebase-disabled');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  function copyToClipboard(text, message) {
Â  Â  Â  Â  Â  Â  // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ document.execCommand('copy') Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ² iframe
Â  Â  Â  Â  Â  Â  const tempInput = document.createElement('input');
Â  Â  Â  Â  Â  Â  tempInput.value = text;
Â  Â  Â  Â  Â  Â  document.body.appendChild(tempInput);
Â  Â  Â  Â  Â  Â  tempInput.select();
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  document.execCommand('copy');
Â  Â  Â  Â  Â  Â  Â  Â  showToast(message || "Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!");
Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  showToast("ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ.");
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Copy failed:', err);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  document.body.removeChild(tempInput);
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- Ğ›ĞĞ“Ğ˜ĞšĞ ĞĞ£Ğ¢Ğ•ĞĞ¢Ğ˜Ğ¤Ğ˜ĞšĞĞ¦Ğ˜Ğ˜ (Ğ¢ĞĞ›Ğ¬ĞšĞ FIREBASE) ---

Â  Â  Â  Â  async function handleLogin() {
Â  Â  Â  Â  Â  Â  const nick = document.getElementById('nickname-input').value.trim();
Â  Â  Â  Â  Â  Â  if(nick.length < 3) return showToast("ĞĞ¸Ğº ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹!");
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (!isFirebaseReady) {
Â  Â  Â  Â  Â  Â  Â  Â  Â return showToast("ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ¯ ĞĞ¨Ğ˜Ğ‘ĞšĞ: ĞĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ²Ğ¾Ğ¹Ñ‚Ğ¸, Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Firebase Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚.");
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  // 1. ĞĞ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ñ‚ÑŒ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğ¹ Ğ²Ñ…Ğ¾Ğ´
Â  Â  Â  Â  Â  Â  Â  Â  if (!auth.currentUser) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await signInAnonymously(auth);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const uid = auth.currentUser.uid;
Â  Â  Â  Â  Â  Â  Â  Â  const userRef = doc(db, PATH_USERS, uid);
Â  Â  Â  Â  Â  Â  Â  Â  const now = Date.now();
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  let canChange = true;
Â  Â  Â  Â  Â  Â  Â  Â  let userData = {};

Â  Â  Â  Â  Â  Â  Â  Â  // 2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ¸ ĞºÑƒĞ»Ğ´Ğ°ÑƒĞ½ Ğ½Ğ° ÑĞ¼ĞµĞ½Ñƒ Ğ½Ğ¸ĞºĞ° (30 Ğ´Ğ½ĞµĞ¹)
Â  Â  Â  Â  Â  Â  Â  Â  const userSnap = await getDoc(userRef);
Â  Â  Â  Â  Â  Â  Â  Â  if (userSnap.exists()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  userData = userSnap.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const lastChange = userData.lastChange || 0;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const COOLDOWN_MS = 2592000000; // 30 Ğ´Ğ½ĞµĞ¹ Ğ² Ğ¼Ñ
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ğ•ÑĞ»Ğ¸ Ğ½Ğ¸Ğº Ğ½Ğµ Ğ¼ĞµĞ½ÑĞ»ÑÑ, Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ ĞºÑƒĞ»Ğ´Ğ°ÑƒĞ½
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (userData.nickname === nick && auth.currentUser.displayName === nick) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  canChange = false;Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (now - lastChange < COOLDOWN_MS) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const daysLeft = Math.ceil((COOLDOWN_MS - (now - lastChange)) / (1000 * 60 * 60 * 24));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  canChange = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(`ĞœĞµĞ½ÑÑ‚ÑŒ Ğ½Ğ¸Ğº Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ· Ğ² 30 Ğ´Ğ½ĞµĞ¹! ĞÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ: ${daysLeft} Ğ´.`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // 3. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ
Â  Â  Â  Â  Â  Â  Â  Â  if (canChange || !userSnap.exists()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await updateProfile(auth.currentUser, { displayName: nick });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await setDoc(userRef, {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nickname: nick,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lastChange: now,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  uid: uidÂ 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }, { merge: true });
Â  Â  Â  Â  Â  Â  Â  Â  } else if (auth.currentUser.displayName !== userData.nickname) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // Ğ•ÑĞ»Ğ¸ ÑĞ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ½Ğ¸Ğº Ğ½ĞµĞ»ÑŒĞ·Ñ, Ğ½Ğ¾ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ² Auth Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ°ĞµÑ‚ÑÑ Ğ¾Ñ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾, Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â await updateProfile(auth.currentUser, { displayName: userData.nickname || 'Anon' });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // 4. Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
Â  Â  Â  Â  Â  Â  Â  Â  updateAuthUI(auth.currentUser);
Â  Â  Â  Â  Â  Â  Â  Â  showToast(`Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ, ${auth.currentUser.displayName}`);
Â  Â  Â  Â  Â  Â  Â  Â  setupFirestoreListeners();

Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Login error:", e);
Â  Â  Â  Â  Â  Â  Â  Â  showToast("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°: " + e.message);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function handleLogout() {
Â  Â  Â  Â  Â  Â  // ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ ÑĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ UI
Â  Â  Â  Â  Â  Â  updateAuthUI(null);
Â  Â  Â  Â  Â  Â  document.getElementById('nickname-input').value = '';
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ĞÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ»Ğ¸ÑÑ‚ĞµĞ½ĞµÑ€Ñ‹ (ĞºÑ€Ğ¾Ğ¼Ğµ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ°Ğ½ĞºĞµÑ‚)
Â  Â  Â  Â  Â  Â  unsubscribeListeners.forEach(unsub => { if (typeof unsub === 'function') unsub(); });
Â  Â  Â  Â  Â  Â  unsubscribeListeners = [];
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ĞŸĞµÑ€ĞµÑ€Ğ¸ÑĞ¾Ğ²Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ°Ğ½ĞºĞµÑ‚Ñ‹
Â  Â  Â  Â  Â  Â  setupProfilesListener();Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  // --- Ğ§ĞĞ¢ ---

Â  Â  Â  Â  async function sendMessage() {
Â  Â  Â  Â  Â  Â  if (!currentUser || !currentUser.displayName) return showToast("ĞĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ Ğ²Ğ¾Ğ¹Ñ‚Ğ¸.");

Â  Â  Â  Â  Â  Â  const input = document.getElementById('chat-input');
Â  Â  Â  Â  Â  Â  const text = input.value.trim();
Â  Â  Â  Â  Â  Â  if (!text) return;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Firebase
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  input.value = '';Â 
Â  Â  Â  Â  Â  Â  Â  Â  await addDoc(collection(db, PATH_CHAT), {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: text,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  author: currentUser.displayName,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  uid: currentUser.uid,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  createdAt: serverTimestamp()
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  showToast("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ: " + e.message);
Â  Â  Â  Â  Â  Â  Â  Â  input.value = text;Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function setupChatListener() {
Â  Â  Â  Â  Â  Â  const chatContainer = document.getElementById('chat-container');
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (!currentUser || !currentUser.displayName) {
Â  Â  Â  Â  Â  Â  Â  Â  chatContainer.innerHTML = '<div class="text-center text-gray-600 mt-10">Ğ’Ğ¾Ğ¹Ğ´Ğ¸Ñ‚Ğµ Ğ² ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ñ‡Ğ°Ñ‚.</div>';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Firebase
Â  Â  Â  Â  Â  Â  // Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ orderBy Ğ´Ğ»Ñ Ğ¸Ğ·Ğ±ĞµĞ¶Ğ°Ğ½Ğ¸Ñ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ½Ğ´ĞµĞºÑĞ°, ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ² JS.
Â  Â  Â  Â  Â  Â  const qChat = query(collection(db, PATH_CHAT), limit(50));
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const unsubscribeChat = onSnapshot(qChat, (snapshot) => {
Â  Â  Â  Â  Â  Â  Â  Â  chatContainer.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  let msgs = [];
Â  Â  Â  Â  Â  Â  Â  Â  snapshot.forEach(d => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = d.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ toMillis() Ğ´Ğ»Ñ Ğ½Ğ°Ğ´ĞµĞ¶Ğ½Ğ¾Ğ¹ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸.
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const timestamp = data.createdAt ? data.createdAt.toMillis() : Date.now();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  msgs.push({ ...data, timestamp });
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ Ğ¿Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ (Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ°Ğ½Ğ¸Ñ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ±Ñ‹Ğ»Ğ¸ Ğ²Ğ½Ğ¸Ğ·Ñƒ)
Â  Â  Â  Â  Â  Â  Â  Â  msgs.sort((a, b) => a.timestamp - b.timestamp);

Â  Â  Â  Â  Â  Â  Â  Â  msgs.forEach(msg => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isOwn = currentUser && msg.uid === currentUser.uid;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  div.className = `p-2 rounded max-w-[80%] ${isOwn ? 'bg-blue-900 ml-auto' : 'bg-[#1f242d] mr-auto'}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `<span class="text-blue-400 font-bold text-xs">${msg.author}</span>: <span class="text-gray-300">${msg.text}</span>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  chatContainer.appendChild(div);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if (!document.getElementById('view-chat').classList.contains('hidden')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  chatContainer.scrollTop = chatContainer.scrollHeight;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }, (error) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â console.error("Chat listener error:", error);
Â  Â  Â  Â  Â  Â  Â  Â  Â showToast("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ñ‡Ğ°Ñ‚Ğ°. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ Firestore.");
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  return unsubscribeChat;
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- ĞĞĞšĞ•Ğ¢Ğ« ---

Â  Â  Â  Â  async function createProfile(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  if (!currentUser || !currentUser.displayName) return showToast("ĞĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ Ğ²Ğ¾Ğ¹Ñ‚Ğ¸.");

Â  Â  Â  Â  Â  Â  const title = document.getElementById('f-title').value.trim();
Â  Â  Â  Â  Â  Â  const role = document.getElementById('f-role').value.trim();
Â  Â  Â  Â  Â  Â  const desc = document.getElementById('f-desc').value.trim();
Â  Â  Â  Â  Â  Â  const contact = document.getElementById('f-contact').value.trim();

Â  Â  Â  Â  Â  Â  if (!title || !role || !desc || !contact) {
Â  Â  Â  Â  Â  Â  Â  Â  return showToast("Ğ’ÑĞµ Ğ¿Ğ¾Ğ»Ñ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹!");
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Firebase
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await addDoc(collection(db, PATH_PROFILES), {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title, role, desc, contact,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  author: currentUser.displayName,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  uid: currentUser.uid,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  createdAt: serverTimestamp()
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  showToast("ĞĞ½ĞºĞµÑ‚Ğ° Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½Ğ°!");
Â  Â  Â  Â  Â  Â  Â  Â  e.target.reset();
Â  Â  Â  Â  Â  Â  Â  Â  window.app.setView('profiles');
Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Create profile error:", err);
Â  Â  Â  Â  Â  Â  Â  Â  showToast("ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ°Ğ½ĞºĞµÑ‚Ñ‹: " + err.message);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderProfiles(profiles) {
Â  Â  Â  Â  Â  Â  const profilesContainer = document.getElementById('profiles-container');
Â  Â  Â  Â  Â  Â  profilesContainer.innerHTML = '';

Â  Â  Â  Â  Â  Â  if (profiles.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  profilesContainer.innerHTML = '<div class="text-gray-500 col-span-full text-center p-4">ĞĞ½ĞºĞµÑ‚ Ğ¿Ğ¾ĞºĞ° Ğ½ĞµÑ‚. Ğ‘ÑƒĞ´ÑŒÑ‚Ğµ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¼!</div>';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  profiles.forEach(data => {
Â  Â  Â  Â  Â  Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  card.className = "bg-[#1f242d] p-4 rounded-xl border border-[#30363d] hover:border-blue-500 transition shadow-lg";
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const profileId = data.id;Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ ÑÑÑ‹Ğ»ĞºÑƒ, ĞºĞ¾Ñ‚Ğ¾Ñ€ÑƒÑ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸ Ğ¿Ğ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ
Â  Â  Â  Â  Â  Â  Â  Â  const profileURL = `${window.location.origin}${window.location.pathname}?profileId=${profileId}`;Â 
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="font-bold text-orange-400 text-lg">${data.title}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-sm text-blue-300 mb-2">Ğ˜Ñ‰ĞµÑ‚: ${data.role}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-300 text-sm mb-3 whitespace-pre-wrap line-clamp-3">${data.desc}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-xs text-gray-500 border-t border-[#30363d] pt-2 flex flex-col sm:flex-row sm:justify-between sm:items-center mt-2 gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="font-medium text-gray-400">ĞĞ²Ñ‚Ğ¾Ñ€: ${data.author}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-col sm:flex-row gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-url="${profileURL}" class="copy-link-btn text-xs text-white bg-green-600 hover:bg-green-700 px-3 py-1 rounded-full transition">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ğŸ”— ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-sm text-white bg-blue-700 px-3 py-1 rounded-full whitespace-nowrap">${data.contact}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const copyBtn = card.querySelector('.copy-link-btn');
Â  Â  Â  Â  Â  Â  Â  Â  copyBtn.addEventListener('click', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const url = e.currentTarget.getAttribute('data-url');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  copyToClipboard(url, "Ğ¡ÑÑ‹Ğ»ĞºĞ° Ğ½Ğ° Ğ°Ğ½ĞºĞµÑ‚Ñƒ ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°!");
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  profilesContainer.appendChild(card);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function setupProfilesListener() {
Â  Â  Â  Â  Â  Â  const profilesContainer = document.getElementById('profiles-container');
Â  Â  Â  Â  Â  Â  profilesContainer.innerHTML = '<div class="text-gray-500 col-span-full text-center p-4">ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ±Ğ°Ğ·Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…...</div>';

Â  Â  Â  Â  Â  Â  if (!isFirebaseReady) {
Â  Â  Â  Â  Â  Â  Â  Â  Â profilesContainer.innerHTML = '<div class="text-red-500 col-span-full text-center p-4">ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Firebase. ĞĞ½ĞºĞµÑ‚Ñ‹ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹.</div>';
Â  Â  Â  Â  Â  Â  Â  Â  Â return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Firebase
Â  Â  Â  Â  Â  Â  // Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ orderBy Ğ´Ğ»Ñ Ğ¸Ğ·Ğ±ĞµĞ¶Ğ°Ğ½Ğ¸Ñ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ½Ğ´ĞµĞºÑĞ°, ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ² JS.
Â  Â  Â  Â  Â  Â  const qProfiles = query(collection(db, PATH_PROFILES), limit(20));

Â  Â  Â  Â  Â  Â  const unsubscribeProfiles = onSnapshot(qProfiles, (snapshot) => {
Â  Â  Â  Â  Â  Â  Â  Â  let profiles = [];
Â  Â  Â  Â  Â  Â  Â  Â  snapshot.forEach(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ toMillis() Ğ´Ğ»Ñ Ğ½Ğ°Ğ´ĞµĞ¶Ğ½Ğ¾Ğ¹ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸.
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const timestamp = data.createdAt ? data.createdAt.toMillis() : Date.now();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  profiles.push({ id: doc.id, ...data, timestamp });
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ (Ğ¿Ğ¾ ÑƒĞ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ±Ñ‹Ğ»Ğ¸ Ğ²Ğ²ĞµÑ€Ñ…Ñƒ)
Â  Â  Â  Â  Â  Â  Â  Â  profiles.sort((a, b) => b.timestamp - a.timestamp);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  renderProfiles(profiles);

Â  Â  Â  Â  Â  Â  }, (error) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â console.error("Profiles listener error:", error);
Â  Â  Â  Â  Â  Â  Â  Â  Â profilesContainer.innerHTML = '<div class="text-red-500 col-span-full text-center p-4">ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ°Ğ½ĞºĞµÑ‚. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸.</div>';
Â  Â  Â  Â  Â  Â  Â  Â  Â showToast("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ°Ğ½ĞºĞµÑ‚.");
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  return unsubscribeProfiles;
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  let unsubscribeListeners = [];

Â  Â  Â  Â  function setupFirestoreListeners() {
Â  Â  Â  Â  Â  Â  // ĞÑ‚Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµĞ¼ÑÑ Ğ¾Ñ‚ ÑÑ‚Ğ°Ñ€Ñ‹Ñ… Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¾Ğº
Â  Â  Â  Â  Â  Â  unsubscribeListeners.forEach(unsub => { if (typeof unsub === 'function') unsub(); });
Â  Â  Â  Â  Â  Â  unsubscribeListeners = [];
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ĞĞ½ĞºĞµÑ‚Ñ‹ Ğ²ÑĞµĞ³Ğ´Ğ° Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼
Â  Â  Â  Â  Â  Â  const profilesUnsub = setupProfilesListener();Â 
Â  Â  Â  Â  Â  Â  if (profilesUnsub) unsubscribeListeners.push(profilesUnsub);

Â  Â  Â  Â  Â  Â  // Ğ§Ğ°Ñ‚ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ²Ğ¾ÑˆĞµĞ»
Â  Â  Â  Â  Â  Â  if (currentUser && currentUser.displayName) {
Â  Â  Â  Â  Â  Â  Â  Â  Â const chatUnsub = setupChatListener();
Â  Â  Â  Â  Â  Â  Â  Â  Â if (chatUnsub) unsubscribeListeners.push(chatUnsub);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- Ğ—ĞĞŸĞ£Ğ¡Ğš ---
Â  Â  Â  Â  
Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  Â  Â  if (isFirebaseReady) {
Â  Â  Â  Â  Â  Â  Â  Â  Â // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ: Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Firebase Auth status
Â  Â  Â  Â  Â  Â  Â  Â  Â onAuthStateChanged(auth, (user) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (user && user.uid) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (user.displayName) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateAuthUI(user);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setupFirestoreListeners();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ĞĞ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğ¹ Ğ²Ñ…Ğ¾Ğ´ Ğ±ĞµĞ· Ğ¸Ğ¼ĞµĞ½Ğ¸: Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ„Ğ¾Ñ€Ğ¼Ñƒ Ğ²Ñ…Ğ¾Ğ´Ğ°
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateAuthUI(null);Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setupProfilesListener(); // ĞĞ½ĞºĞµÑ‚Ñ‹ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ĞĞµ Ğ²Ğ¾ÑˆĞµĞ»
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â updateAuthUI(null);Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â setupProfilesListener(); // ĞĞ½ĞºĞµÑ‚Ñ‹ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Ğ•ÑĞ»Ğ¸ Firebase Ğ½Ğµ Ğ³Ğ¾Ñ‚Ğ¾Ğ², Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ Ğ² Ğ°Ğ½ĞºĞµÑ‚Ğ°Ñ…
Â  Â  Â  Â  Â  Â  Â  Â  setupProfilesListener();
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â // ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.nav-btn').forEach(btn => {
Â  Â  Â  Â  Â  Â  Â  Â  btn.addEventListener('click', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (e.currentTarget.classList.contains('firebase-disabled') && !currentUser) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return showToast("ĞĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾. Ğ’Ğ¾Ğ¹Ğ´Ğ¸Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ñƒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ.");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.app.setView(btn.dataset.view);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  // ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ’Ñ…Ğ¾Ğ´
Â  Â  Â  Â  Â  Â  document.getElementById('login-btn').addEventListener('click', handleLogin);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ½Ğ¸Ğº
Â  Â  Â  Â  Â  Â  document.getElementById('logout-btn').addEventListener('click', handleLogout);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ĞšĞ½Ğ¾Ğ¿ĞºĞ° ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
Â  Â  Â  Â  Â  Â  const sendMsgBtn = document.getElementById('send-msg-btn');
Â  Â  Â  Â  Â  Â  sendMsgBtn.addEventListener('click', sendMessage);
Â  Â  Â  Â  Â  Â  document.getElementById('chat-input').addEventListener('keypress', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (e.key === 'Enter') sendMessage();
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  // Ğ¤Ğ¾Ñ€Ğ¼Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ°Ğ½ĞºĞµÑ‚Ñ‹
Â  Â  Â  Â  Â  Â  document.getElementById('create-form').addEventListener('submit', createProfile);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  window.app.setView('profiles');
Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>
